<div class="container mx-auto p-4 max-w-3xl">
  <div class="bg-white rounded-lg shadow-md p-6">
    <div class="flex items-center justify-between mb-6">
      <h1 class="text-2xl font-bold text-gray-800">Añadir nuevo producto</h1>
      <button 
        class="text-green-600 hover:text-green-700 font-medium flex items-center"
        (click)="router.navigate(['/home'])"
      >
        <i class="bi bi-arrow-left mr-1"></i> Volver
      </button>
    </div>

    <form (ngSubmit)="createProduct()">
      <!-- Información básica -->
      <div class="mb-6">
        <h2 class="text-lg font-semibold text-gray-700 mb-3 border-b pb-2">Información básica</h2>
        
        <!-- Input de imágenes -->
        <div class="mb-4">
          <label for="productImageUrls" class="block text-sm font-medium text-gray-700 mb-1">
            Imágenes del producto (máx. {{ maxImages }}) *
          </label>
          <input 
            type="file" 
            (change)="onFilesSelected($event)" 
            id="productImageUrls" 
            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500"
            multiple 
            accept="image/*"
            [disabled]="imageFiles.length >= maxImages"
          >
          <p class="text-sm text-gray-600 mt-1">
            Puedes subir {{ imagesRemaining }} imagen{{ imagesRemaining === 1 ? '' : 'es' }} más.
          </p>
        </div>

        <!-- Vista previa de imágenes -->
        <div *ngIf="imagePreviews.length > 0" class="mb-4">
          <h3 class="text-sm font-medium text-gray-700 mb-2">Imágenes seleccionadas:</h3>
          <div class="grid grid-cols-2 sm:grid-cols-3 gap-4">
            <div *ngFor="let preview of imagePreviews; let i = index" class="relative">
              <img 
                [src]="preview" 
                alt="Vista previa de imagen {{ i + 1 }}" 
                class="w-full h-32 object-cover rounded-md border border-gray-300"
              >
              <button 
                type="button" 
                (click)="removeImage(i)" 
                class="absolute top-1 right-1 bg-red-600 text-white rounded-full p-1 hover:bg-red-700"
                title="Eliminar imagen"
              >
                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                </svg>
              </button>
            </div>
          </div>
        </div>

        <!-- Título -->
        <div class="mb-4">
          <label for="title" class="block text-sm font-medium text-gray-700 mb-1">Título del producto *</label>
          <input 
            type="text" 
            id="title" 
            [(ngModel)]="productData.title" 
            name="title" 
            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500"
            placeholder="Ej: Camiseta de algodón"
            required
          >
        </div>

        <!-- Categoría -->
        <div class="mb-4">
          <label for="category" class="block text-sm font-medium text-gray-700 mb-1">Categoría *</label>
          <select 
            id="category" 
            [(ngModel)]="productData.category" 
            name="category" 
            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500"
            required
          >
            <option value="" disabled selected>Selecciona una categoría</option>
            <option value="Electrónica">Electrónica</option>
            <option value="Ropa">Ropa</option>
            <option value="Hogar">Hogar</option>
            <option value="Deportes">Deportes</option>
          </select>
        </div>

        <!-- Descripción -->
        <div class="mb-4">
          <label for="description" class="block text-sm font-medium text-gray-700 mb-1">Descripción *</label>
          <textarea 
            id="description" 
            [(ngModel)]="productData.description" 
            name="description" 
            rows="4"
            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500"
            placeholder="Describe tu producto, incluye detalles sobre el estado, características, etc."
            required
          ></textarea>
        </div>
      </div>

      <!-- Precio -->
      <div class="mb-6">
        <h2 class="text-lg font-semibold text-gray-700 mb-3 border-b pb-2">Precio</h2>
        <div class="mb-4">
          <label for="price" class="block text-sm font-medium text-gray-700 mb-1">Precio (SC) *</label>
          <input 
            type="number" 
            id="price" 
            [(ngModel)]="productData.price" 
            name="price" 
            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500"
            placeholder="0.00"
            step="0.01"
            min="0"
            required
          >
        </div>
      </div>

      <!-- Indicador de carga -->
      <div *ngIf="isUploading" class="mb-4 text-center">
        <p class="text-gray-600">Subiendo imágenes, por favor espera...</p>
        <div class="spinner-border animate-spin inline-block w-8 h-8 border-4 rounded-full border-t-green-600"></div>
      </div>

      <!-- Botones de acción -->
      <div class="flex justify-end space-x-3 mt-8">
        <button 
          type="button" 
          class="px-4 py-2 border border-gray-300 rounded-md text-gray-700 bg-white hover:bg-gray-50"
          (click)="router.navigate(['/home'])"
          [disabled]="isUploading"
        >
          Cancelar
        </button>
        <button 
          type="submit" 
          class="px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2"
          [disabled]="isUploading"
        >
          Publicar producto
        </button>
      </div>
    </form>
  </div>
</div>